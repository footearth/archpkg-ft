# Maintainer: FooTearth <footearth@gmail.com>

pkgname=phlinux
pkgver=1.1
pkgrel=1
pkedesc="phlinux is a free DDNS (Dynamic DNS) client software"
arch=('i686')
url="http://www.oray.cn"
# license=('')
# depends=('')
backup=(etc/phlinux.conf)
source=(http://www.oray.cn/peanuthull/download/phlinux10all.tar.gz)
md5sums=('4c7941f7eeb16f17647ef19f85f37dfa')
install=phlinux.install

build(){
	tar xvf $srcdir/${pkgname}10all/${pkgname}_package/${pkgname}-${pkgver}-install.ubuntu.8.04.tar.gz -C $srcdir

	install -d $pkgdir/{etc,usr}
	install -d $pkgdir/usr/bin
	install -d $pkgdir/usr/share/$pkgname/webadmin
	install -Dm755 $srcdir/${pkgname}_install/phlinux $pkgdir/usr/bin
	install -Dm644 $srcdir/${pkgname}_install/webadmin/{*.jpg,*.gif} $pkgdir/usr/share/$pkgname/webadmin

	cd $srcdir
	{
		echo "[settings]"
		echo "szBindAddress = 0.0.0.0"
		echo "szHost = PhLinux3.Oray.Net"
		echo "szServiceHost = phservice2.oray.net"
		echo "szUserID ="
		echo "szUserPWD ="
		echo "nUserType = 0"
		echo "bStartMiniHttp = 1"
		echo "httproot = /usr/share/phlinux/webadmin"
		echo "runas ="
		echo "lang = cn"
		echo ""
		echo "[log]"
		echo "file = /var/log/phlinux.log"
		echo "level = 1"
	} > phlinux.conf
	sed '/oray/s/net\/ImgOray\/2005\/11\/20051102_PH3_236x57.jpg/cn\/images\/logo.gif/' $srcdir/${pkgname}_install/webadmin/index.html > index.html

	install -Dm644 $srcdir/phlinux.conf $pkgdir/etc
	install -Dm644 $srcdir/index.html $pkgdir/usr/share/$pkgname/webadmin
}
